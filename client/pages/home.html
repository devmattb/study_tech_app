<!--

***/
*
*   Created: 03 December 2017
*   @author Matt Bergstrom, A.K.A devmattb or Mattias Bergström.
*   Copyright 2017 Matt Bergstrom
*   Statement:
*   None of this code is to be copied or used without my (Matt Bergstroms') permission.
*
***/

-->
<template name="home">

  {{>header}}
  {{>preloader}}
  {{>navbar}}
  {{>eventDescModal}}
  <div id="" class="row">
      <div class="col s12">
        <br><br>
        <h4 style="font-size: 26px; position: relative; bottom: -10px;" class="center grey-text text-darken-4">DAGENS SCHEMA</h4>
      </div>
      <div class="col s12">
        <div class="schedule"></div>
      </div>
      <div class="col s12">
        <button onclick="findSmth()" style="position: absolute; bottom 1000px!important; right: 100px;" class="red btn waves-effect waves-light"> FIND </button>
      </div>
      <div class="col s12">
        <button onclick="addDesc()" style="position: absolute; bottom 0px; right: 0px;" class="btn waves-effect waves-light"> ADD DESC </button>
      </div>
  </div>

  <script>

  function findSmth() {
    //alert(Samhällskunskap.find({examinationType: "Skriftligt Prov"}));

    // var testArr = ["182011122018","161811122018","202211122018","161812122018"];
    //
    // for(var i = 0; i < testArr.length; i++) {
    //   if ( "161812122018" == testArr[i] ){
    //     alert("COLLISION");
    //   }
    // }
    const connectedUserId = Session.get("id").toString();
      var forbiddenDatesArr = new Array();
      var forbiddenDatesCollection = CalEvents.find({connectedUserId, connectedUserId});
      forbiddenDatesCollection.forEach(function(data){
          /**
          *   To filter out forbidden dates easily, we construct a standard format of dates, using strings. The format looks like the following:
          *
          *   ForbiddenDateString Format:   START-TIME+END-TIME+DAY+MONTH+YEAR
          *
          *   Where we get these paramaters from the students current schedule in our database:
          *
          *   START-TIME:             data.start.substring(11,13)
          *   END-TIME:               data.end.substring(11,13)
          *   DAY:                    data.start.substring(8,10)
          *   MONTH:                  data.start.substring(5,7)
          *   YEAR:                   data.start.substring(0,4)
          **/
          forbiddenDateString =
          data.start.substring(11,13)+ // START-TIME
          data.end.substring(11,13)+   // END-TIME
          data.start.substring(8,10)+  // DAY
          data.start.substring(5,7)+   // MONTH
          data.start.substring(0,4);   // YEAR
          forbiddenDatesArr.push(forbiddenDateString); // Add to our forbiddenTimesArr.
      });
      console.log(forbiddenDatesArr);
  }


function addDesc() {
  var docs = [];
  var docEx = ["Litteraturanalys", "Skriftligt Prov", "Glosor", "Muntlig Redovisning", "Uppsats"];
  var docDesc = ["Lit bro","Skriftligt bro","Glosor bro","Muntlig bro", "Redovisning bro", "Uppsats bro"];
  for (var i = 0; i < 5; i++) {
      docs[i] = {
        examinationType: docEx[i],
        phase: parseInt(Math.random()*5+1),
        desc: docDesc[i],
      };
  }

  for (var i = 0; i < 5; i++) {
    Samhällskunskap.insert(docs[i]);
    Språk.insert(docs[i]);
    Kvantitativ.insert(docs[i]);
  }
}

  // var courseType = "Samhällskunskap";
  // var exType = "Skriftligt Prov";
  // console.log(Samhällskunskap.find({examinationType: exType}));

  </script>

  </template>
